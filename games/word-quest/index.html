<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Word Quest</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="/style.css" />
    <link rel="stylesheet" href="../common/styles/common.css" />
    <link rel="stylesheet" href="styles/main.css" />
    <link rel="icon" href="/favicon.ico" type="image/x-icon" />
    <style>
      /* Debug - ensure content is visible */
      #game-container {
        display: block !important;
        visibility: visible !important;
        min-height: 100vh;
      }

      /* Override breadcrumb styling for quest theme */
      #title-screen .breadcrumbs {
        margin-bottom: 1rem;
        justify-content: center;
      }
      #title-screen .breadcrumbs a {
        color: #c17817;
        font-weight: 600;
      }
      #title-screen .breadcrumbs a:hover {
        color: #d4922f;
      }
      #title-screen .breadcrumbs .separator {
        color: #d4a574;
      }
      #title-screen .breadcrumbs .current {
        color: #8b5a00;
        font-weight: 600;
      }
    </style>
  </head>
  <body>
    <div id="game-container" role="main" aria-label="Word Quest Game">
      <!-- Title Screen -->
      <div id="title-screen" class="screen active" role="region" aria-label="Title screen">
        <nav class="breadcrumbs" aria-label="Breadcrumb navigation">
          <a href="/">Home</a>
          <span class="separator">/</span>
          <a href="/games/">Games</a>
          <span class="separator">/</span>
          <span class="current" aria-current="page">Word Quest</span>
        </nav>
        <h1 class="game-title">üìú Word Quest üóùÔ∏è</h1>
        <p class="subtitle">Decode the ancient words!</p>
        <div class="title-buttons">
          <button id="start-button" class="big-button" aria-label="Start a new quest">
            Start Quest
          </button>
          <button
            id="continue-button"
            class="big-button hidden"
            aria-label="Continue your previous quest"
          >
            Continue Quest
          </button>
          <button
            id="start-fresh-button"
            class="secondary-button hidden"
            aria-label="Start a fresh quest, resetting all progress"
          >
            New Quest
          </button>
        </div>
      </div>

      <!-- Quest Map Screen -->
      <div id="quest-map" class="screen" role="region" aria-label="Quest map">
        <div class="header">
          <div>
            <h2>Quest Map</h2>
            <button id="home-button" class="text-button" aria-label="Return to start screen">
              ‚Üê Home
            </button>
          </div>
          <div class="header-actions">
            <button
              id="word-gallery-button"
              class="icon-button"
              title="Word Gallery"
              aria-label="View word gallery"
            >
              üìö
            </button>
            <button
              id="settings-button"
              class="icon-button"
              title="Settings"
              aria-label="Open settings"
            >
              ‚öôÔ∏è
            </button>
          </div>
        </div>

        <div class="map-container">
          <div class="decoder-rank" role="status" aria-live="polite">
            <span id="rank-display" aria-label="Current decoder rank">Apprentice Decoder</span>
            <span id="stars-display" aria-label="Total stars earned">‚≠ê 0 Stars</span>
          </div>

          <div class="quest-paths" role="list" aria-label="Available quests">
            <!-- Quest areas will be dynamically added here -->
          </div>
        </div>
      </div>

      <!-- Word Gallery Screen -->
      <div id="word-gallery-screen" class="screen" role="region" aria-label="Word gallery">
        <div class="header">
          <button id="gallery-back-button" class="nav-button" aria-label="Return to quest map">
            ‚Üê Back
          </button>
          <h2>Your Word Gallery üìö</h2>
        </div>

        <div class="gallery-container">
          <div class="gallery-stats">
            <div class="stat-card">
              <span class="stat-value" id="gallery-words-count">0</span>
              <span class="stat-label">Words Learned</span>
            </div>
            <div class="stat-card">
              <span class="stat-value" id="gallery-quests-count">0</span>
              <span class="stat-label">Quests Completed</span>
            </div>
            <div class="stat-card">
              <span class="stat-value" id="gallery-stars-count">0</span>
              <span class="stat-label">Total Stars</span>
            </div>
          </div>

          <div id="word-cards-grid" class="word-cards-grid">
            <!-- Word cards will be dynamically inserted here -->
          </div>
        </div>
      </div>

      <!-- Activity Screen -->
      <div id="activity-screen" class="screen" role="region" aria-label="Activity screen">
        <div class="header">
          <button id="back-to-map-button" class="nav-button" aria-label="Return to quest map">
            ‚Üê Map
          </button>
          <div class="activity-header-info">
            <h3 id="quest-name">Sound Cipher</h3>
            <div class="progress-info" role="status" aria-live="polite">
              <span id="activity-progress" aria-label="Current progress">Question 1 of 5</span>
              <span id="activity-stars" aria-label="Stars earned">‚≠ê 0</span>
            </div>
          </div>
          <button
            id="activity-settings-button"
            class="icon-button"
            title="Settings"
            aria-label="Open settings"
          >
            ‚öôÔ∏è
          </button>
        </div>

        <div class="activity-content">
          <!-- Creature Guide -->
          <div class="creature-guide">
            <div id="quest-creature" class="creature-icon" aria-hidden="true">üïµÔ∏è</div>
            <p id="creature-narrative" class="creature-narrative" role="status" aria-live="polite">
              Ready to start!
            </p>
          </div>

          <div id="activity-question" class="question-area" role="region" aria-label="Question">
            <!-- Activity content will be dynamically generated -->
          </div>

          <div
            id="activity-choices"
            class="choices-area"
            role="radiogroup"
            aria-label="Answer choices"
          >
            <!-- Choices will be dynamically generated -->
          </div>

          <div
            id="activity-feedback"
            class="feedback-area hidden"
            role="status"
            aria-live="assertive"
            aria-atomic="true"
          >
            <!-- Feedback messages -->
          </div>
        </div>

        <div class="activity-controls">
          <button id="submit-answer" class="big-button" disabled aria-label="Submit your answer">
            Submit
          </button>
          <button id="next-activity" class="big-button hidden" aria-label="Go to next activity">
            Next ‚Üí
          </button>
        </div>
      </div>

      <!-- Level Complete Screen -->
      <div id="level-complete" class="screen" role="region" aria-label="Level completion">
        <div class="celebration">
          <h2>üéâ Quest Complete! üéâ</h2>
          <div id="completion-message" class="completion-message" role="status" aria-live="polite">
            <!-- Dynamic completion message -->
          </div>
          <div id="rewards-display" class="rewards" role="region" aria-label="Rewards earned">
            <!-- Rewards will be shown here -->
          </div>
          <div class="completion-buttons">
            <button
              id="continue-quest-button"
              class="big-button"
              aria-label="Continue to next quest"
            >
              Next Quest ‚Üí
            </button>
            <button
              id="return-to-map-button"
              class="secondary-button"
              aria-label="Return to quest map"
            >
              Quest Map
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Settings Modal -->
    <div id="settings-modal" class="modal hidden">
      <div class="modal-content">
        <h2>Settings ‚öôÔ∏è</h2>

        <div class="setting-group">
          <label for="difficulty-select">Difficulty Level:</label>
          <select id="difficulty-select" class="setting-select">
            <option value="explorer">Explorer (K-1st Grade)</option>
            <option value="adventurer">Adventurer (1st-2nd Grade)</option>
            <option value="master">Master (2nd-3rd Grade)</option>
          </select>
          <p class="setting-description">Choose the difficulty level for questions</p>
        </div>

        <div class="setting-group">
          <label for="questions-per-level-select">Questions Per Level:</label>
          <select id="questions-per-level-select" class="setting-select">
            <option value="3">3 Questions (Quick)</option>
            <option value="5">5 Questions (Standard)</option>
            <option value="8">8 Questions (Practice)</option>
          </select>
          <p class="setting-description">How many questions to complete each level</p>
        </div>

        <div class="setting-group">
          <label for="input-mode-select">Answer Input:</label>
          <select id="input-mode-select" class="setting-select">
            <option value="multipleChoice">Multiple Choice</option>
            <option value="keyboard">Type Answer</option>
          </select>
          <p class="setting-description">Choose how to answer questions</p>
        </div>

        <div class="setting-group">
          <label for="audio-hints-select">Audio Hints:</label>
          <select id="audio-hints-select" class="setting-select">
            <option value="true">On</option>
            <option value="false">Off</option>
          </select>
          <p class="setting-description">Play word sounds</p>
        </div>

        <button id="close-settings" class="big-button">Done</button>
      </div>
    </div>

    <!-- Game Scripts -->
    <script type="module" src="js/storage.js"></script>
    <script type="module" src="js/WordBank.js"></script>
    <script type="module" src="js/GameState.js"></script>
    <script type="module" src="js/WordActivityGenerator.js"></script>
    <script type="module" src="js/GameUI.js"></script>
    <script type="module" src="js/SoundManager.js"></script>
    <script type="module" src="js/EventManager.js"></script>
    <script type="module" src="js/game.js"></script>
  </body>
</html>
