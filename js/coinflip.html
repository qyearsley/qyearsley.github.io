<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Coin Flips Experiment - Quinten Yearsley</title>
    <meta
      name="description"
      content="Interactive experiment demonstrating how coin flip frequencies converge to 50% as the number of flips increases."
    />
    <link rel="stylesheet" href="/style.css" />
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  </head>

  <body>
    <div class="container">
      <header class="header">
        <h1>Coin Flips Experiment</h1>
        <p>Demonstrating probability convergence through interactive coin flipping</p>
      </header>

      <main class="main-content">
        <section class="section">
          <p>
            In probability theory, small sample sizes can be misleading. Flip a coin 10 times and
            you might get 30% or 80% heads. But flip it 10,000 times and the frequency will almost
            certainly be very close to 50%.
          </p>

          <p>
            This experiment demonstrates this convergence. It flips coins from 1 to your chosen
            maximum, recording the percentage of heads at each step. The graph shows how the
            frequency approaches 50% as the number of flips increases.
          </p>

          <form id="form" action="javascript:void(update())">
            <input type="text" id="numSamples" value="400" />
            <input type="submit" />
          </form>

          <div style="position: relative; height: 300px; width: 800px">
            <canvas id="myCanvas"></canvas>
          </div>
        </section>

        <section class="section">
          <h2>Navigation</h2>
          <ul class="external-links">
            <li><a href="/js/">← Back to JavaScript experiments</a></li>
            <li><a href="/">← Back to main page</a></li>
          </ul>
        </section>
      </main>
    </div>

    <script>
      "use strict"

      let chart = null

      /*
       * Graph the visualization given the input from the form.
       */
      function update() {
        var canvas = document.getElementById("myCanvas")
        var numSamples = parseInt(document.getElementById("numSamples").value)
        var frequencies = flip(numSamples)

        // Create labels for x-axis (1 to numSamples)
        var labels = Array.from({ length: numSamples }, (_, i) => i + 1)

        // Destroy existing chart if it exists
        if (chart) {
          chart.destroy()
        }

        // Create new chart
        chart = new Chart(canvas, {
          type: "line",
          data: {
            labels: labels,
            datasets: [
              {
                label: "Frequency of Heads",
                data: frequencies,
                borderColor: "#8AB87D",
                backgroundColor: "rgba(138, 184, 125, 0.1)",
                borderWidth: 2,
                fill: false,
                tension: 0,
                pointRadius: 0,
                pointHoverRadius: 3,
              },
            ],
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            scales: {
              y: {
                beginAtZero: false,
                min: 0.15,
                max: 0.85,
                grid: {
                  color: "rgba(150, 150, 150, 0.3)",
                  drawBorder: false,
                },
                ticks: {
                  callback: function (value) {
                    return (value * 100).toFixed(0) + "%"
                  },
                },
              },
              x: {
                grid: {
                  display: false,
                },
                title: {
                  display: true,
                  text: "Number of Coin Flips",
                },
              },
            },
            plugins: {
              title: {
                display: true,
                text: "Coin Flip Frequency Convergence",
              },
              legend: {
                display: false,
              },
            },
            interaction: {
              intersect: false,
              mode: "index",
            },
          },
        })
      }

      /*
       * For each number |i| from 1 to |numSampleSets|, flip a coin |i| times
       * record the proportion of heads As |i| increases, this number reliably
       * approaches 0.5. Return an array of the proportion of heads for each |i|.
       */
      function flip(numSampleSets) {
        var frequencies = []
        for (var i = 1; i <= numSampleSets; i++) {
          var sum = 0
          for (var j = 0; j < i; j++) {
            // Math.random() is not exactly like flipping a coin;
            // it returns a number between 0 and 1.
            sum += Math.random()
          }
          frequencies[i] = sum / i
        }
        frequencies.shift()
        return frequencies
      }

      // Initialize chart on page load
      document.addEventListener("DOMContentLoaded", function () {
        update()
      })
    </script>
  </body>
</html>
